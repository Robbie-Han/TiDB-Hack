(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory();
	else if(typeof define === 'function' && define.amd)
		define([], factory);
	else if(typeof exports === 'object')
		exports["Circular"] = factory();
	else
		root["Circular"] = factory();
})(window, function() {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./plugins/circular/index.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./node_modules/_@antv_util@1.3.1@@antv/util/lib/deep-mix.js":
/*!*******************************************************************!*\
  !*** ./node_modules/_@antv_util@1.3.1@@antv/util/lib/deep-mix.js ***!
  \*******************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var isPlainObject = __webpack_require__(/*! ./type/is-plain-object */ "./node_modules/_@antv_util@1.3.1@@antv/util/lib/type/is-plain-object.js");
var isArray = __webpack_require__(/*! ./type/is-array */ "./node_modules/_@antv_util@1.3.1@@antv/util/lib/type/is-array.js");

var MAX_MIX_LEVEL = 5;

function _deepMix(dist, src, level, maxLevel) {
  level = level || 0;
  maxLevel = maxLevel || MAX_MIX_LEVEL;
  for (var key in src) {
    if (src.hasOwnProperty(key)) {
      var value = src[key];
      if (value !== null && isPlainObject(value)) {
        if (!isPlainObject(dist[key])) {
          dist[key] = {};
        }
        if (level < maxLevel) {
          _deepMix(dist[key], value, level + 1, maxLevel);
        } else {
          dist[key] = src[key];
        }
      } else if (isArray(value)) {
        dist[key] = [];
        dist[key] = dist[key].concat(value);
      } else if (value !== undefined) {
        dist[key] = value;
      }
    }
  }
}

var deepMix = function deepMix() {
  var args = new Array(arguments.length);
  var length = args.length;
  for (var i = 0; i < length; i++) {
    args[i] = arguments[i];
  }
  var rst = args[0];
  for (var _i = 1; _i < length; _i++) {
    _deepMix(rst, args[_i]);
  }
  return rst;
};

module.exports = deepMix;

/***/ }),

/***/ "./node_modules/_@antv_util@1.3.1@@antv/util/lib/each.js":
/*!***************************************************************!*\
  !*** ./node_modules/_@antv_util@1.3.1@@antv/util/lib/each.js ***!
  \***************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var isObject = __webpack_require__(/*! ./type/is-object */ "./node_modules/_@antv_util@1.3.1@@antv/util/lib/type/is-object.js");
var isArray = __webpack_require__(/*! ./type/is-array */ "./node_modules/_@antv_util@1.3.1@@antv/util/lib/type/is-array.js");

var each = function each(elements, func) {
  if (!elements) {
    return;
  }
  var rst = void 0;
  if (isArray(elements)) {
    for (var i = 0, len = elements.length; i < len; i++) {
      rst = func(elements[i], i);
      if (rst === false) {
        break;
      }
    }
  } else if (isObject(elements)) {
    for (var k in elements) {
      if (elements.hasOwnProperty(k)) {
        rst = func(elements[k], k);
        if (rst === false) {
          break;
        }
      }
    }
  }
};

module.exports = each;

/***/ }),

/***/ "./node_modules/_@antv_util@1.3.1@@antv/util/lib/event/wrap-behavior.js":
/*!******************************************************************************!*\
  !*** ./node_modules/_@antv_util@1.3.1@@antv/util/lib/event/wrap-behavior.js ***!
  \******************************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/**
 * 封装事件，便于使用上下文this,和便于解除事件时使用
 * @protected
 * @param  {Object} obj   对象
 * @param  {String} action 事件名称
 * @return {Function}        返回事件处理函数
 */
function wrapBehavior(obj, action) {
  if (obj['_wrap_' + action]) {
    return obj['_wrap_' + action];
  }
  var method = function method(e) {
    obj[action](e);
  };
  obj['_wrap_' + action] = method;
  return method;
}

module.exports = wrapBehavior;

/***/ }),

/***/ "./node_modules/_@antv_util@1.3.1@@antv/util/lib/type/is-array.js":
/*!************************************************************************!*\
  !*** ./node_modules/_@antv_util@1.3.1@@antv/util/lib/type/is-array.js ***!
  \************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var isType = __webpack_require__(/*! ./is-type */ "./node_modules/_@antv_util@1.3.1@@antv/util/lib/type/is-type.js");

var isArray = Array.isArray ? Array.isArray : function (value) {
  return isType(value, 'Array');
};

module.exports = isArray;

/***/ }),

/***/ "./node_modules/_@antv_util@1.3.1@@antv/util/lib/type/is-object-like.js":
/*!******************************************************************************!*\
  !*** ./node_modules/_@antv_util@1.3.1@@antv/util/lib/type/is-object-like.js ***!
  \******************************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

var isObjectLike = function isObjectLike(value) {
  /**
   * isObjectLike({}) => true
   * isObjectLike([1, 2, 3]) => true
   * isObjectLike(Function) => false
   * isObjectLike(null) => false
   */
  return (typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object' && value !== null;
};

module.exports = isObjectLike;

/***/ }),

/***/ "./node_modules/_@antv_util@1.3.1@@antv/util/lib/type/is-object.js":
/*!*************************************************************************!*\
  !*** ./node_modules/_@antv_util@1.3.1@@antv/util/lib/type/is-object.js ***!
  \*************************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

var isObject = function isObject(value) {
  /**
   * isObject({}) => true
   * isObject([1, 2, 3]) => true
   * isObject(Function) => true
   * isObject(null) => false
   */
  var type = typeof value === 'undefined' ? 'undefined' : _typeof(value);
  return value !== null && type === 'object' || type === 'function';
};

module.exports = isObject;

/***/ }),

/***/ "./node_modules/_@antv_util@1.3.1@@antv/util/lib/type/is-plain-object.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/_@antv_util@1.3.1@@antv/util/lib/type/is-plain-object.js ***!
  \*******************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var isObjectLike = __webpack_require__(/*! ./is-object-like */ "./node_modules/_@antv_util@1.3.1@@antv/util/lib/type/is-object-like.js");
var isType = __webpack_require__(/*! ./is-type */ "./node_modules/_@antv_util@1.3.1@@antv/util/lib/type/is-type.js");

var isPlainObject = function isPlainObject(value) {
  /**
   * isObjectLike(new Foo) => false
   * isObjectLike([1, 2, 3]) => false
   * isObjectLike({ x: 0, y: 0 }) => true
   * isObjectLike(Object.create(null)) => true
   */
  if (!isObjectLike(value) || !isType(value, 'Object')) {
    return false;
  }
  if (Object.getPrototypeOf(value) === null) {
    return true;
  }
  var proto = value;
  while (Object.getPrototypeOf(proto) !== null) {
    proto = Object.getPrototypeOf(proto);
  }
  return Object.getPrototypeOf(value) === proto;
};

module.exports = isPlainObject;

/***/ }),

/***/ "./node_modules/_@antv_util@1.3.1@@antv/util/lib/type/is-type.js":
/*!***********************************************************************!*\
  !*** ./node_modules/_@antv_util@1.3.1@@antv/util/lib/type/is-type.js ***!
  \***********************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

var toString = {}.toString;
var isType = function isType(value, type) {
  return toString.call(value) === '[object ' + type + ']';
};

module.exports = isType;

/***/ }),

/***/ "./plugins/base.js":
/*!*************************!*\
  !*** ./plugins/base.js ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var deepMix = __webpack_require__(/*! @antv/util/lib/deep-mix */ "./node_modules/_@antv_util@1.3.1@@antv/util/lib/deep-mix.js");

var each = __webpack_require__(/*! @antv/util/lib/each */ "./node_modules/_@antv_util@1.3.1@@antv/util/lib/each.js");

var wrapBehavior = __webpack_require__(/*! @antv/util/lib/event/wrap-behavior */ "./node_modules/_@antv_util@1.3.1@@antv/util/lib/event/wrap-behavior.js");

var PluginBase =
/*#__PURE__*/
function () {
  function PluginBase(cfgs) {
    this._cfgs = deepMix(this.getDefaultCfgs(), cfgs);
  }

  var _proto = PluginBase.prototype;

  _proto.getDefaultCfgs = function getDefaultCfgs() {
    return {};
  };

  _proto.initPlugin = function initPlugin(graph) {
    var self = this;
    self.set('graph', graph);
    var events = self.getEvents();
    var bindEvents = {};
    each(events, function (v, k) {
      var event = wrapBehavior(self, v);
      bindEvents[k] = event;
      graph.on(k, event);
    });
    this._events = bindEvents;
    this.init();
  };

  _proto.init = function init() {};

  _proto.getEvents = function getEvents() {
    return {};
  };

  _proto.get = function get(key) {
    return this._cfgs[key];
  };

  _proto.set = function set(key, val) {
    this._cfgs[key] = val;
  };

  _proto.destroy = function destroy() {};

  _proto.destroyPlugin = function destroyPlugin() {
    this.destroy();
    var graph = this.get('graph');
    var events = this._events;
    each(events, function (v, k) {
      graph.off(k, v);
    });
    this._events = null;
    this._cfgs = null;
    this.destroyed = true;
  };

  return PluginBase;
}();

module.exports = PluginBase;

/***/ }),

/***/ "./plugins/circular/index.js":
/*!***********************************!*\
  !*** ./plugins/circular/index.js ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }

// const Numeric = require('numericjs');
var Base = __webpack_require__(/*! ../base */ "./plugins/base.js");

function getDegree(n, nodeMap, edges) {
  var degrees = [];

  for (var i = 0; i < n; i++) {
    degrees[i] = 0;
  }

  edges.forEach(function (e) {
    degrees[nodeMap.get(e.source)] += 1;
    degrees[nodeMap.get(e.target)] += 1;
  });
  return degrees;
}

function initHierarchy(nodes, edges, nodeMap, directed) {
  nodes.forEach(function (n, i) {
    nodes[i].children = [];
    nodes[i].parent = [];
  });

  if (directed) {
    edges.forEach(function (e) {
      var sourceIdx = nodeMap.get(e.source);
      var targetIdx = nodeMap.get(e.target);
      nodes[sourceIdx].children.push(nodes[targetIdx]);
      nodes[targetIdx].parent.push(nodes[sourceIdx]);
    });
  } else {
    edges.forEach(function (e) {
      var sourceIdx = nodeMap.get(e.source);
      var targetIdx = nodeMap.get(e.target);
      nodes[sourceIdx].children.push(nodes[targetIdx]);
      nodes[targetIdx].children.push(nodes[sourceIdx]);
    });
  }
}

function connect(a, b, edges) {
  var m = edges.length;

  for (var i = 0; i < m; i++) {
    if (a.id === edges[i].source && b.id === edges[i].target || b.id === edges[i].source && a.id === edges[i].target) {
      return true;
    }
  }

  return false;
}

function compareDegree(a, b) {
  if (a.degree < b.degree) {
    return -1;
  }

  if (a.degree > b.degree) {
    return 1;
  }

  return 0;
}

var Circular =
/*#__PURE__*/
function (_Base) {
  _inheritsLoose(Circular, _Base);

  function Circular() {
    return _Base.apply(this, arguments) || this;
  }

  var _proto = Circular.prototype;

  _proto.getDefaultCfgs = function getDefaultCfgs() {
    return {
      center: [0, 0],
      // 布局中心
      startAngle: 0,
      // 默认起始角度
      endAngle: 2 * Math.PI,
      // 默认终止角度
      radius: null,
      // 默认固定半径，若设置了 radius，则 startRadius 与 endRadius 不起效
      startRadius: null,
      // 默认起始半径
      endRadius: null,
      // 默认终止半径
      nodeSize: 10,
      // 节点半径
      clockwise: true,
      // 是否顺时针
      divisions: 1,
      // 节点在环上分成段数（几个段将均匀分布），在 endRadius - startRadius != 0 时生效
      ordering: null,
      // 节点在环上排序的依据。可选: 'topology', 'degree', 'null'
      angleRatio: 1,
      // how many 2*pi from first to last nodes
      onLayoutEnd: function onLayoutEnd() {},
      // 布局完成回调
      onTick: function onTick() {} // 每一迭代布局回调

    };
  };

  _proto.init = function init() {
    var graph = this.get('graph');
    var onTick = this.get('onTick');

    var tick = function tick() {
      onTick && onTick();
      graph.refreshPositions();
    };

    this.set('tick', tick);
  };

  _proto.layout = function layout(data) {
    var self = this;
    self.set('data', data);
    var graph = self.get('graph');
    var nodes = data.nodes;
    var edges = data.edges;
    var n = nodes.length;
    var center = self.get('center');

    if (n === 0) {
      return;
    } else if (n === 1) {
      nodes[0].x = center[0];
      nodes[0].y = center[1];
      return;
    }

    var radius = self.get('radius');
    var startRadius = self.get('startRadius');
    var endRadius = self.get('endRadius');
    var divisions = self.get('divisions');
    var startAngle = self.get('startAngle');
    var endAngle = self.get('endAngle');
    var angleStep = (endAngle - startAngle) / n; // 如果正在布局，忽略布局请求

    if (self.isTicking()) {
      return;
    } // layout


    var nodeMap = new Map();
    nodes.forEach(function (node, i) {
      nodeMap.set(node.id, i);
    });
    self.set('nodeMap', nodeMap);
    var degrees = getDegree(nodes.length, nodeMap, edges);
    self.set('degrees', degrees);
    var width = graph.get('width');
    var height = graph.get('height');

    if (!radius && !startRadius && !endRadius) {
      radius = height > width ? width / 2 : height / 2;
    } else if (!startRadius && endRadius) {
      startRadius = endRadius;
    } else if (startRadius && !endRadius) {
      endRadius = startRadius;
    }

    var angleRatio = self.get('angleRatio');
    var astep = angleStep * angleRatio;
    self.set('astep', astep);
    var ordering = self.get('ordering');
    var layoutNodes = [];

    if (ordering === 'topology') {
      // layout according to the topology
      layoutNodes = self.topologyOrdering();
    } else if (ordering === 'degree') {
      // layout according to the descent order of degrees
      layoutNodes = self.degreeOrdering();
    } else {
      // layout according to the original order in the data.nodes
      layoutNodes = nodes;
    }

    var clockwise = self.get('clockwise');
    var divN = Math.ceil(n / divisions); // node number in each division

    for (var i = 0; i < n; ++i) {
      var r = radius;

      if (!r) {
        r = startRadius + i * (endRadius - startRadius) / (n - 1);
      }

      var angle = startAngle + i % divN * astep + 2 * Math.PI / divisions * Math.floor(i / divN);

      if (!clockwise) {
        angle = endAngle - i % divN * astep - 2 * Math.PI / divisions * Math.floor(i / divN);
      }

      layoutNodes[i].x = center[0] + Math.cos(angle) * r;
      layoutNodes[i].y = center[1] + Math.sin(angle) * r;
      layoutNodes[i].weight = degrees[i];
    }

    graph.refreshPositions();
    var onLayoutEnd = self.get('onLayoutEnd');
    onLayoutEnd();
  };

  _proto.topologyOrdering = function topologyOrdering() {
    var self = this;
    var degrees = self.get('degrees');
    var data = self.get('data');
    var edges = data.edges;
    var nodes = data.nodes;
    var nodeMap = self.get('nodeMap');
    var orderedNodes = [nodes[0]];
    var pickFlags = [];
    var n = nodes.length;
    pickFlags[0] = true;
    initHierarchy(nodes, edges, nodeMap, false);
    var k = 0;
    nodes.forEach(function (node, i) {
      if (i === 0) return;else if ((i === n - 1 || degrees[i] !== degrees[i + 1] || connect(orderedNodes[k], node, edges)) && pickFlags[i] !== true) {
        orderedNodes.push(node);
        pickFlags[i] = true;
        k++;
      } else {
        var children = orderedNodes[k].children;
        var foundChild = false;

        for (var j = 0; j < children.length; ++j) {
          var childIdx = nodeMap.get(children[j].id);

          if (degrees[childIdx] === degrees[i] && pickFlags[childIdx] !== true) {
            orderedNodes.push(nodes[childIdx]);
            pickFlags[childIdx] = true;
            foundChild = true;
            break;
          }
        }

        var ii = 0;

        while (!foundChild) {
          if (!pickFlags[ii]) {
            orderedNodes.push(nodes[ii]);
            pickFlags[ii] = true;
            foundChild = true;
          }

          ii++;
          if (ii === n) break;
        }
      }
    });
    return orderedNodes;
  };

  _proto.degreeOrdering = function degreeOrdering() {
    var self = this;
    var nodes = self.get('data').nodes;
    var orderedNodes = [];
    var degrees = self.get('degrees');
    nodes.forEach(function (node, i) {
      node.degree = degrees[i];
      orderedNodes.push(node);
    });
    orderedNodes.sort(compareDegree);
    return orderedNodes;
  };

  _proto.updateLayout = function updateLayout(cfg) {
    var self = this;
    var data = cfg.data;

    if (data) {
      self.set('data', data);
    }

    if (self.get('ticking')) {
      // stop layout
      self.set('ticking', false);
    }

    Object.keys(cfg).forEach(function (key) {
      self.set(key, cfg[key]);
    });
    self.layout(data);
  };

  _proto.isTicking = function isTicking() {
    return this.get('ticking');
  };

  _proto.destroy = function destroy() {
    if (this.get('ticking')) {
      this.getSimulation().stop();
    }

    _Base.prototype.destroy.call(this);
  };

  return Circular;
}(Base);

module.exports = Circular;

/***/ })

/******/ });
});
//# sourceMappingURL=circular.js.map